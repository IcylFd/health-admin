{"remainingRequest":"/Users/lifangdi/workspace/iview-admin/node_modules/babel-loader/lib/index.js!/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lifangdi/workspace/iview-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lifangdi/workspace/iview-admin/src/components/tables/tables.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lifangdi/workspace/iview-admin/src/components/tables/tables.vue","mtime":1551926733000},{"path":"/Users/lifangdi/workspace/iview-admin/.babelrc","mtime":1548038358000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.assign\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport TablesEdit from './edit.vue';\nimport handleBtns from './handle-btns';\nimport './index.less';\nexport default {\n  name: 'Tables',\n  props: {\n    value: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    columns: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    size: String,\n    width: {\n      type: [Number, String]\n    },\n    height: {\n      type: [Number, String]\n    },\n    stripe: {\n      type: Boolean,\n      default: false\n    },\n    border: {\n      type: Boolean,\n      default: false\n    },\n    showHeader: {\n      type: Boolean,\n      default: true\n    },\n    highlightRow: {\n      type: Boolean,\n      default: false\n    },\n    rowClassName: {\n      type: Function,\n      default: function _default() {\n        return '';\n      }\n    },\n    context: {\n      type: Object\n    },\n    noDataText: {\n      type: String\n    },\n    noFilteredDataText: {\n      type: String\n    },\n    disabledHover: {\n      type: Boolean\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n\n    /**\n     * @description 全局设置是否可编辑\n     */\n    editable: {\n      type: Boolean,\n      default: false\n    },\n\n    /**\n     * @description 是否可搜索\n     */\n    searchable: {\n      type: Boolean,\n      default: false\n    },\n\n    /**\n     * @description 搜索控件所在位置，'top' / 'bottom'\n     */\n    searchPlace: {\n      type: String,\n      default: 'top'\n    }\n  },\n\n  /**\n   * Events\n   * @on-start-edit 返回值 {Object} ：同iview中render函数中的params对象 { row, index, column }\n   * @on-cancel-edit 返回值 {Object} 同上\n   * @on-save-edit 返回值 {Object} ：除上面三个参数外，还有一个value: 修改后的数据\n   */\n  data: function data() {\n    return {\n      insideColumns: [],\n      insideTableData: [],\n      edittingCellId: '',\n      edittingText: '',\n      searchValue: '',\n      searchKey: ''\n    };\n  },\n  methods: {\n    suportEdit: function suportEdit(item, index) {\n      var _this = this;\n\n      item.render = function (h, params) {\n        return h(TablesEdit, {\n          props: {\n            params: params,\n            value: _this.insideTableData[params.index][params.column.key],\n            edittingCellId: _this.edittingCellId,\n            editable: _this.editable\n          },\n          on: {\n            'input': function input(val) {\n              _this.edittingText = val;\n            },\n            'on-start-edit': function onStartEdit(params) {\n              _this.edittingCellId = \"editting-\".concat(params.index, \"-\").concat(params.column.key);\n\n              _this.$emit('on-start-edit', params);\n            },\n            'on-cancel-edit': function onCancelEdit(params) {\n              _this.edittingCellId = '';\n\n              _this.$emit('on-cancel-edit', params);\n            },\n            'on-save-edit': function onSaveEdit(params) {\n              _this.value[params.row.initRowIndex][params.column.key] = _this.edittingText;\n\n              _this.$emit('input', _this.value);\n\n              _this.$emit('on-save-edit', Object.assign(params, {\n                value: _this.edittingText\n              }));\n\n              _this.edittingCellId = '';\n            }\n          }\n        });\n      };\n\n      return item;\n    },\n    surportHandle: function surportHandle(item) {\n      var _this2 = this;\n\n      var options = item.options || [];\n      var insideBtns = [];\n      options.forEach(function (item) {\n        if (handleBtns[item]) insideBtns.push(handleBtns[item]);\n      });\n      var btns = item.button ? [].concat(insideBtns, item.button) : insideBtns;\n\n      item.render = function (h, params) {\n        params.tableData = _this2.value;\n        return h('div', btns.map(function (item) {\n          return item(h, params, _this2);\n        }));\n      };\n\n      return item;\n    },\n    handleColumns: function handleColumns(columns) {\n      var _this3 = this;\n\n      this.insideColumns = columns.map(function (item, index) {\n        var res = item;\n        if (res.editable) res = _this3.suportEdit(res, index);\n        if (res.key === 'handle') res = _this3.surportHandle(res);\n        return res;\n      });\n    },\n    setDefaultSearchKey: function setDefaultSearchKey() {\n      this.searchKey = this.columns[0].key !== 'handle' ? this.columns[0].key : this.columns.length > 1 ? this.columns[1].key : '';\n    },\n    handleClear: function handleClear(e) {\n      if (e.target.value === '') this.insideTableData = this.value;\n    },\n    handleSearch: function handleSearch() {\n      var _this4 = this;\n\n      this.insideTableData = this.value.filter(function (item) {\n        return item[_this4.searchKey].indexOf(_this4.searchValue) > -1;\n      });\n    },\n    handleTableData: function handleTableData() {\n      this.insideTableData = this.value.map(function (item, index) {\n        var res = item;\n        res.initRowIndex = index;\n        return res;\n      });\n    },\n    exportCsv: function exportCsv(params) {\n      this.$refs.tablesMain.exportCsv(params);\n    },\n    clearCurrentRow: function clearCurrentRow() {\n      this.$refs.talbesMain.clearCurrentRow();\n    },\n    onCurrentChange: function onCurrentChange(currentRow, oldCurrentRow) {\n      this.$emit('on-current-change', currentRow, oldCurrentRow);\n    },\n    onSelect: function onSelect(selection, row) {\n      this.$emit('on-select', selection, row);\n    },\n    onSelectCancel: function onSelectCancel(selection, row) {\n      this.$emit('on-select-cancel', selection, row);\n    },\n    onSelectAll: function onSelectAll(selection) {\n      this.$emit('on-select-all', selection);\n    },\n    onSelectionChange: function onSelectionChange(selection) {\n      this.$emit('on-selection-change', selection);\n    },\n    onSortChange: function onSortChange(column, key, order) {\n      this.$emit('on-sort-change', column, key, order);\n    },\n    onFilterChange: function onFilterChange(row) {\n      this.$emit('on-filter-change', row);\n    },\n    onRowClick: function onRowClick(row, index) {\n      this.$emit('on-row-click', row, index);\n    },\n    onRowDblclick: function onRowDblclick(row, index) {\n      this.$emit('on-row-dblclick', row, index);\n    },\n    onExpand: function onExpand(row, status) {\n      this.$emit('on-expand', row, status);\n    }\n  },\n  watch: {\n    columns: function columns(_columns) {\n      this.handleColumns(_columns);\n      this.setDefaultSearchKey();\n    },\n    value: function value(val) {\n      this.handleTableData();\n      if (this.searchable) this.handleSearch();\n    }\n  },\n  mounted: function mounted() {\n    this.handleColumns(this.columns);\n    this.setDefaultSearchKey();\n    this.handleTableData();\n  }\n};",{"version":3,"sources":["tables.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div v-if=\"searchable && searchPlace === 'top'\" class=\"search-con search-con-top\">\n      <Select v-model=\"searchKey\" class=\"search-col\">\n        <Option v-for=\"item in columns\" v-if=\"item.key !== 'handle'\" :value=\"item.key\" :key=\"`search-col-${item.key}`\">{{ item.title }}</Option>\n      </Select>\n      <Input @on-change=\"handleClear\" clearable placeholder=\"输入关键字搜索\" class=\"search-input\" v-model=\"searchValue\"/>\n      <Button @click=\"handleSearch\" class=\"search-btn\" type=\"primary\"><Icon type=\"search\"/>搜索</Button>\n    </div>\n    <Table\n      ref=\"tablesMain\"\n      :data=\"insideTableData\"\n      :columns=\"insideColumns\"\n      :stripe=\"stripe\"\n      :border=\"border\"\n      :show-header=\"showHeader\"\n      :width=\"width\"\n      :height=\"height\"\n      :loading=\"loading\"\n      :disabled-hover=\"disabledHover\"\n      :highlight-row=\"highlightRow\"\n      :row-class-name=\"rowClassName\"\n      :size=\"size\"\n      :no-data-text=\"noDataText\"\n      :no-filtered-data-text=\"noFilteredDataText\"\n      @on-current-change=\"onCurrentChange\"\n      @on-select=\"onSelect\"\n      @on-select-cancel=\"onSelectCancel\"\n      @on-select-all=\"onSelectAll\"\n      @on-selection-change=\"onSelectionChange\"\n      @on-sort-change=\"onSortChange\"\n      @on-filter-change=\"onFilterChange\"\n      @on-row-click=\"onRowClick\"\n      @on-row-dblclick=\"onRowDblclick\"\n      @on-expand=\"onExpand\"\n    >\n      <slot name=\"header\" slot=\"header\"></slot>\n      <slot name=\"footer\" slot=\"footer\"></slot>\n      <slot name=\"loading\" slot=\"loading\"></slot>\n    </Table>\n    <div v-if=\"searchable && searchPlace === 'bottom'\" class=\"search-con search-con-top\">\n      <Select v-model=\"searchKey\" class=\"search-col\">\n        <Option v-for=\"item in columns\" v-if=\"item.key !== 'handle'\" :value=\"item.key\" :key=\"`search-col-${item.key}`\">{{ item.title }}</Option>\n      </Select>\n      <Input placeholder=\"输入关键字搜索\" class=\"search-input\" v-model=\"searchValue\"/>\n      <Button class=\"search-btn\" type=\"primary\"><Icon type=\"search\"/>搜索</Button>\n    </div>\n    <a id=\"hrefToExportTable\" style=\"display: none;width: 0px;height: 0px;\"></a>\n  </div>\n</template>\n\n<script>\nimport TablesEdit from './edit.vue'\nimport handleBtns from './handle-btns'\nimport './index.less'\nexport default {\n  name: 'Tables',\n  props: {\n    value: {\n      type: Array,\n      default () {\n        return []\n      }\n    },\n    columns: {\n      type: Array,\n      default () {\n        return []\n      }\n    },\n    size: String,\n    width: {\n      type: [Number, String]\n    },\n    height: {\n      type: [Number, String]\n    },\n    stripe: {\n      type: Boolean,\n      default: false\n    },\n    border: {\n      type: Boolean,\n      default: false\n    },\n    showHeader: {\n      type: Boolean,\n      default: true\n    },\n    highlightRow: {\n      type: Boolean,\n      default: false\n    },\n    rowClassName: {\n      type: Function,\n      default () {\n        return ''\n      }\n    },\n    context: {\n      type: Object\n    },\n    noDataText: {\n      type: String\n    },\n    noFilteredDataText: {\n      type: String\n    },\n    disabledHover: {\n      type: Boolean\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    /**\n     * @description 全局设置是否可编辑\n     */\n    editable: {\n      type: Boolean,\n      default: false\n    },\n    /**\n     * @description 是否可搜索\n     */\n    searchable: {\n      type: Boolean,\n      default: false\n    },\n    /**\n     * @description 搜索控件所在位置，'top' / 'bottom'\n     */\n    searchPlace: {\n      type: String,\n      default: 'top'\n    }\n  },\n  /**\n   * Events\n   * @on-start-edit 返回值 {Object} ：同iview中render函数中的params对象 { row, index, column }\n   * @on-cancel-edit 返回值 {Object} 同上\n   * @on-save-edit 返回值 {Object} ：除上面三个参数外，还有一个value: 修改后的数据\n   */\n  data () {\n    return {\n      insideColumns: [],\n      insideTableData: [],\n      edittingCellId: '',\n      edittingText: '',\n      searchValue: '',\n      searchKey: ''\n    }\n  },\n  methods: {\n    suportEdit (item, index) {\n      item.render = (h, params) => {\n        return h(TablesEdit, {\n          props: {\n            params: params,\n            value: this.insideTableData[params.index][params.column.key],\n            edittingCellId: this.edittingCellId,\n            editable: this.editable\n          },\n          on: {\n            'input': val => {\n              this.edittingText = val\n            },\n            'on-start-edit': (params) => {\n              this.edittingCellId = `editting-${params.index}-${params.column.key}`\n              this.$emit('on-start-edit', params)\n            },\n            'on-cancel-edit': (params) => {\n              this.edittingCellId = ''\n              this.$emit('on-cancel-edit', params)\n            },\n            'on-save-edit': (params) => {\n              this.value[params.row.initRowIndex][params.column.key] = this.edittingText\n              this.$emit('input', this.value)\n              this.$emit('on-save-edit', Object.assign(params, {value: this.edittingText}))\n              this.edittingCellId = ''\n            }\n          }\n        })\n      }\n      return item\n    },\n    surportHandle (item) {\n      let options = item.options || []\n      let insideBtns = []\n      options.forEach(item => {\n        if (handleBtns[item]) insideBtns.push(handleBtns[item])\n      })\n      let btns = item.button ? [].concat(insideBtns, item.button) : insideBtns\n      item.render = (h, params) => {\n        params.tableData = this.value\n        return h('div', btns.map(item => item(h, params, this)))\n      }\n      return item\n    },\n    handleColumns (columns) {\n      this.insideColumns = columns.map((item, index) => {\n        let res = item\n        if (res.editable) res = this.suportEdit(res, index)\n        if (res.key === 'handle') res = this.surportHandle(res)\n        return res\n      })\n    },\n    setDefaultSearchKey () {\n      this.searchKey = this.columns[0].key !== 'handle' ? this.columns[0].key : (this.columns.length > 1 ? this.columns[1].key : '')\n    },\n    handleClear (e) {\n      if (e.target.value === '') this.insideTableData = this.value\n    },\n    handleSearch () {\n      this.insideTableData = this.value.filter(item => item[this.searchKey].indexOf(this.searchValue) > -1)\n    },\n    handleTableData () {\n      this.insideTableData = this.value.map((item, index) => {\n        let res = item\n        res.initRowIndex = index\n        return res\n      })\n    },\n    exportCsv (params) {\n      this.$refs.tablesMain.exportCsv(params)\n    },\n    clearCurrentRow () {\n      this.$refs.talbesMain.clearCurrentRow()\n    },\n    onCurrentChange (currentRow, oldCurrentRow) {\n      this.$emit('on-current-change', currentRow, oldCurrentRow)\n    },\n    onSelect (selection, row) {\n      this.$emit('on-select', selection, row)\n    },\n    onSelectCancel (selection, row) {\n      this.$emit('on-select-cancel', selection, row)\n    },\n    onSelectAll (selection) {\n      this.$emit('on-select-all', selection)\n    },\n    onSelectionChange (selection) {\n      this.$emit('on-selection-change', selection)\n    },\n    onSortChange (column, key, order) {\n      this.$emit('on-sort-change', column, key, order)\n    },\n    onFilterChange (row) {\n      this.$emit('on-filter-change', row)\n    },\n    onRowClick (row, index) {\n      this.$emit('on-row-click', row, index)\n    },\n    onRowDblclick (row, index) {\n      this.$emit('on-row-dblclick', row, index)\n    },\n    onExpand (row, status) {\n      this.$emit('on-expand', row, status)\n    }\n  },\n  watch: {\n    columns (columns) {\n      this.handleColumns(columns)\n      this.setDefaultSearchKey()\n    },\n    value (val) {\n      this.handleTableData()\n      if (this.searchable) this.handleSearch()\n    }\n  },\n  mounted () {\n    this.handleColumns(this.columns)\n    this.setDefaultSearchKey()\n    this.handleTableData()\n  }\n}\n</script>\n"],"sourceRoot":"src/components/tables"}]}