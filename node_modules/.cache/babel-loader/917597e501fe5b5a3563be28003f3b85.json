{"remainingRequest":"/Users/lifangdi/workspace/iview-admin/node_modules/babel-loader/lib/index.js!/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lifangdi/workspace/iview-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lifangdi/workspace/iview-admin/src/view/components/org-tree/components/org-view.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lifangdi/workspace/iview-admin/src/view/components/org-tree/components/org-view.vue","mtime":1548038358000},{"path":"/Users/lifangdi/workspace/iview-admin/.babelrc","mtime":1548038358000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { on, off } from '@/libs/tools';\nvar menuList = [{\n  key: 'edit',\n  label: '编辑部门'\n}, {\n  key: 'detail',\n  label: '查看部门'\n}, {\n  key: 'new',\n  label: '新增子部门'\n}, {\n  key: 'delete',\n  label: '删除部门'\n}];\nexport default {\n  name: 'OrgView',\n  props: {\n    zoomHandled: {\n      type: Number,\n      default: 1\n    },\n    data: Object\n  },\n  data: function data() {\n    return {\n      currentContextMenuId: '',\n      orgTreeOffsetLeft: 0,\n      orgTreeOffsetTop: 0,\n      initPageX: 0,\n      initPageY: 0,\n      oldMarginLeft: 0,\n      oldMarginTop: 0,\n      canMove: false\n    };\n  },\n  computed: {\n    orgTreeStyle: function orgTreeStyle() {\n      return {\n        transform: \"translate(-50%, -50%) scale(\".concat(this.zoomHandled, \", \").concat(this.zoomHandled, \")\"),\n        marginLeft: \"\".concat(this.orgTreeOffsetLeft, \"px\"),\n        marginTop: \"\".concat(this.orgTreeOffsetTop, \"px\")\n      };\n    }\n  },\n  methods: {\n    handleNodeClick: function handleNodeClick(e, data, expand) {\n      expand();\n    },\n    closeMenu: function closeMenu() {\n      this.currentContextMenuId = '';\n    },\n    getBgColor: function getBgColor(data) {\n      return this.currentContextMenuId === data.id ? data.isRoot ? '#0d7fe8' : '#5d6c7b' : '';\n    },\n    nodeRender: function nodeRender(h, data) {\n      return h(\"div\", {\n        \"class\": ['custom-org-node', data.children && data.children.length ? 'has-children-label' : ''],\n        on: {\n          \"mousedown\": function mousedown(event) {\n            return event.stopPropagation();\n          },\n          \"contextmenu\": this.contextmenu.bind(this, data)\n        }\n      }, [data.label, h(\"dropdown\", {\n        attrs: {\n          trigger: \"custom\",\n          visible: this.currentContextMenuId === data.id\n        },\n        \"class\": \"context-menu\",\n        nativeOn: {\n          \"click\": this.handleDropdownClick\n        },\n        on: {\n          \"on-click\": this.handleContextMenuClick.bind(this, data)\n        },\n        style: {\n          transform: \"scale(\".concat(1 / this.zoomHandled, \", \").concat(1 / this.zoomHandled, \")\")\n        },\n        directives: [{\n          name: \"click-outside\",\n          value: this.closeMenu\n        }]\n      }, [h(\"dropdown-menu\", {\n        slot: \"list\"\n      }, [menuList.map(function (item) {\n        return h(\"dropdown-item\", {\n          attrs: {\n            name: item.key\n          }\n        }, [item.label]);\n      })])])]);\n    },\n    contextmenu: function contextmenu(data, $event) {\n      var event = $event || window.event;\n      event.preventDefault ? event.preventDefault() : event.returnValue = false;\n      this.currentContextMenuId = data.id;\n    },\n    setDepartmentData: function setDepartmentData(data) {\n      data.isRoot = true;\n      this.departmentData = data;\n    },\n    mousedownView: function mousedownView(event) {\n      this.canMove = true;\n      this.initPageX = event.pageX;\n      this.initPageY = event.pageY;\n      this.oldMarginLeft = this.orgTreeOffsetLeft;\n      this.oldMarginTop = this.orgTreeOffsetTop;\n      on(document, 'mousemove', this.mousemoveView);\n      on(document, 'mouseup', this.mouseupView);\n    },\n    mousemoveView: function mousemoveView(event) {\n      if (!this.canMove) return;\n      var pageX = event.pageX,\n          pageY = event.pageY;\n      this.orgTreeOffsetLeft = this.oldMarginLeft + pageX - this.initPageX;\n      this.orgTreeOffsetTop = this.oldMarginTop + pageY - this.initPageY;\n    },\n    mouseupView: function mouseupView() {\n      this.canMove = false;\n      off(document, 'mousemove', this.mousemoveView);\n      off(document, 'mouseup', this.mouseupView);\n    },\n    handleDropdownClick: function handleDropdownClick(event) {\n      event.stopPropagation();\n    },\n    handleDocumentContextmenu: function handleDocumentContextmenu() {\n      this.canMove = false;\n    },\n    handleContextMenuClick: function handleContextMenuClick(data, key) {\n      this.$emit('on-menu-click', {\n        data: data,\n        key: key\n      });\n    }\n  },\n  mounted: function mounted() {\n    on(document, 'contextmenu', this.handleDocumentContextmenu);\n  },\n  beforeDestroy: function beforeDestroy() {\n    off(document, 'contextmenu', this.handleDocumentContextmenu);\n  }\n};",{"version":3,"sources":["org-view.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div\n    ref=\"dragWrapper\"\n    class=\"org-tree-drag-wrapper\"\n    @mousedown=\"mousedownView\"\n    @contextmenu=\"handleDocumentContextmenu\"\n  >\n    <div class=\"org-tree-wrapper\" :style=\"orgTreeStyle\">\n      <v-org-tree\n        v-if=\"data\"\n        :data=\"data\"\n        :node-render=\"nodeRender\"\n        :expand-all=\"true\"\n        @on-node-click=\"handleNodeClick\"\n        collapsable\n      ></v-org-tree>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { on, off } from '@/libs/tools'\nconst menuList = [\n  {\n    key: 'edit',\n    label: '编辑部门'\n  },\n  {\n    key: 'detail',\n    label: '查看部门'\n  },\n  {\n    key: 'new',\n    label: '新增子部门'\n  },\n  {\n    key: 'delete',\n    label: '删除部门'\n  }\n]\nexport default {\n  name: 'OrgView',\n  props: {\n    zoomHandled: {\n      type: Number,\n      default: 1\n    },\n    data: Object\n  },\n  data () {\n    return {\n      currentContextMenuId: '',\n      orgTreeOffsetLeft: 0,\n      orgTreeOffsetTop: 0,\n      initPageX: 0,\n      initPageY: 0,\n      oldMarginLeft: 0,\n      oldMarginTop: 0,\n      canMove: false\n    }\n  },\n  computed: {\n    orgTreeStyle () {\n      return {\n        transform: `translate(-50%, -50%) scale(${this.zoomHandled}, ${\n          this.zoomHandled\n        })`,\n        marginLeft: `${this.orgTreeOffsetLeft}px`,\n        marginTop: `${this.orgTreeOffsetTop}px`\n      }\n    }\n  },\n  methods: {\n    handleNodeClick (e, data, expand) {\n      expand()\n    },\n    closeMenu () {\n      this.currentContextMenuId = ''\n    },\n    getBgColor (data) {\n      return this.currentContextMenuId === data.id\n        ? data.isRoot\n          ? '#0d7fe8'\n          : '#5d6c7b'\n        : ''\n    },\n    nodeRender (h, data) {\n      return (\n        <div\n          class={[\n            'custom-org-node',\n            data.children && data.children.length ? 'has-children-label' : ''\n          ]}\n          on-mousedown={event => event.stopPropagation()}\n          on-contextmenu={this.contextmenu.bind(this, data)}\n        >\n          {data.label}\n          <dropdown\n            trigger=\"custom\"\n            class=\"context-menu\"\n            visible={this.currentContextMenuId === data.id}\n            nativeOn-click={this.handleDropdownClick}\n            on-on-click={this.handleContextMenuClick.bind(this, data)}\n            style={{\n              transform: `scale(${1 / this.zoomHandled}, ${1 /\n                this.zoomHandled})`\n            }}\n            v-click-outside={this.closeMenu}\n          >\n            <dropdown-menu slot=\"list\">\n              {menuList.map(item => {\n                return (\n                  <dropdown-item name={item.key}>{item.label}</dropdown-item>\n                )\n              })}\n            </dropdown-menu>\n          </dropdown>\n        </div>\n      )\n    },\n    contextmenu (data, $event) {\n      let event = $event || window.event\n      event.preventDefault\n        ? event.preventDefault()\n        : (event.returnValue = false)\n      this.currentContextMenuId = data.id\n    },\n    setDepartmentData (data) {\n      data.isRoot = true\n      this.departmentData = data\n    },\n    mousedownView (event) {\n      this.canMove = true\n      this.initPageX = event.pageX\n      this.initPageY = event.pageY\n      this.oldMarginLeft = this.orgTreeOffsetLeft\n      this.oldMarginTop = this.orgTreeOffsetTop\n      on(document, 'mousemove', this.mousemoveView)\n      on(document, 'mouseup', this.mouseupView)\n    },\n    mousemoveView (event) {\n      if (!this.canMove) return\n      const { pageX, pageY } = event\n      this.orgTreeOffsetLeft = this.oldMarginLeft + pageX - this.initPageX\n      this.orgTreeOffsetTop = this.oldMarginTop + pageY - this.initPageY\n    },\n    mouseupView () {\n      this.canMove = false\n      off(document, 'mousemove', this.mousemoveView)\n      off(document, 'mouseup', this.mouseupView)\n    },\n    handleDropdownClick (event) {\n      event.stopPropagation()\n    },\n    handleDocumentContextmenu () {\n      this.canMove = false\n    },\n    handleContextMenuClick (data, key) {\n      this.$emit('on-menu-click', { data, key })\n    }\n  },\n  mounted () {\n    on(document, 'contextmenu', this.handleDocumentContextmenu)\n  },\n  beforeDestroy () {\n    off(document, 'contextmenu', this.handleDocumentContextmenu)\n  }\n}\n</script>\n\n<style>\n</style>\n"],"sourceRoot":"src/view/components/org-tree/components"}]}