{"remainingRequest":"/Users/lifangdi/workspace/iview-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lifangdi/workspace/iview-admin/src/view/excel/upload-excel.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lifangdi/workspace/iview-admin/src/view/excel/upload-excel.vue","mtime":1548038358000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lifangdi/workspace/iview-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport excel from '@/libs/excel'\nexport default {\n  name: 'upload-excel',\n  data () {\n    return {\n      uploadLoading: false,\n      progressPercent: 0,\n      showProgress: false,\n      showRemoveFile: false,\n      file: null,\n      tableData: [],\n      tableTitle: [],\n      tableLoading: false\n    }\n  },\n  methods: {\n    initUpload () {\n      this.file = null\n      this.showProgress = false\n      this.loadingProgress = 0\n      this.tableData = []\n      this.tableTitle = []\n    },\n    handleUploadFile () {\n      this.initUpload()\n    },\n    handleRemove () {\n      this.initUpload()\n      this.$Message.info('上传的文件已删除！')\n    },\n    handleBeforeUpload (file) {\n      const fileExt = file.name.split('.').pop().toLocaleLowerCase()\n      if (fileExt === 'xlsx' || fileExt === 'xls') {\n        this.readFile(file)\n        this.file = file\n      } else {\n        this.$Notice.warning({\n          title: '文件类型错误',\n          desc: '文件：' + file.name + '不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。'\n        })\n      }\n      return false\n    },\n    // 读取文件\n    readFile (file) {\n      const reader = new FileReader()\n      reader.readAsArrayBuffer(file)\n      reader.onloadstart = e => {\n        this.uploadLoading = true\n        this.tableLoading = true\n        this.showProgress = true\n      }\n      reader.onprogress = e => {\n        this.progressPercent = Math.round(e.loaded / e.total * 100)\n      }\n      reader.onerror = e => {\n        this.$Message.error('文件读取出错')\n      }\n      reader.onload = e => {\n        this.$Message.info('文件读取成功')\n        const data = e.target.result\n        const { header, results } = excel.read(data, 'array')\n        const tableTitle = header.map(item => { return { title: item, key: item } })\n        this.tableData = results\n        this.tableTitle = tableTitle\n        this.uploadLoading = false\n        this.tableLoading = false\n        this.showRemoveFile = true\n      }\n    }\n  },\n  created () {\n\n  },\n  mounted () {\n\n  }\n}\n",{"version":3,"sources":["upload-excel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA","file":"upload-excel.vue","sourceRoot":"src/view/excel","sourcesContent":["<style lang=\"less\">\n  @import \"./common.less\";\n</style>\n<template>\n  <div>\n    <Card title=\"导入EXCEL\">\n      <Row>\n        <Upload action=\"\" :before-upload=\"handleBeforeUpload\" accept=\".xls, .xlsx\">\n          <Button icon=\"ios-cloud-upload-outline\" :loading=\"uploadLoading\" @click=\"handleUploadFile\">上传文件</Button>\n        </Upload>\n      </Row>\n      <Row>\n        <div class=\"ivu-upload-list-file\" v-if=\"file !== null\">\n          <Icon type=\"ios-stats\"></Icon>\n            {{ file.name }}\n          <Icon v-show=\"showRemoveFile\" type=\"ios-close\" class=\"ivu-upload-list-remove\" @click.native=\"handleRemove()\"></Icon>\n        </div>\n      </Row>\n      <Row>\n        <transition name=\"fade\">\n          <Progress v-if=\"showProgress\" :percent=\"progressPercent\" :stroke-width=\"2\">\n            <div v-if=\"progressPercent == 100\">\n              <Icon type=\"ios-checkmark-circle\"></Icon>\n              <span>成功</span>\n            </div>\n          </Progress>\n        </transition>\n      </Row>\n    </Card>\n    <Row class=\"margin-top-10\">\n      <Table :columns=\"tableTitle\" :data=\"tableData\" :loading=\"tableLoading\"></Table>\n    </Row>\n  </div>\n</template>\n<script>\nimport excel from '@/libs/excel'\nexport default {\n  name: 'upload-excel',\n  data () {\n    return {\n      uploadLoading: false,\n      progressPercent: 0,\n      showProgress: false,\n      showRemoveFile: false,\n      file: null,\n      tableData: [],\n      tableTitle: [],\n      tableLoading: false\n    }\n  },\n  methods: {\n    initUpload () {\n      this.file = null\n      this.showProgress = false\n      this.loadingProgress = 0\n      this.tableData = []\n      this.tableTitle = []\n    },\n    handleUploadFile () {\n      this.initUpload()\n    },\n    handleRemove () {\n      this.initUpload()\n      this.$Message.info('上传的文件已删除！')\n    },\n    handleBeforeUpload (file) {\n      const fileExt = file.name.split('.').pop().toLocaleLowerCase()\n      if (fileExt === 'xlsx' || fileExt === 'xls') {\n        this.readFile(file)\n        this.file = file\n      } else {\n        this.$Notice.warning({\n          title: '文件类型错误',\n          desc: '文件：' + file.name + '不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。'\n        })\n      }\n      return false\n    },\n    // 读取文件\n    readFile (file) {\n      const reader = new FileReader()\n      reader.readAsArrayBuffer(file)\n      reader.onloadstart = e => {\n        this.uploadLoading = true\n        this.tableLoading = true\n        this.showProgress = true\n      }\n      reader.onprogress = e => {\n        this.progressPercent = Math.round(e.loaded / e.total * 100)\n      }\n      reader.onerror = e => {\n        this.$Message.error('文件读取出错')\n      }\n      reader.onload = e => {\n        this.$Message.info('文件读取成功')\n        const data = e.target.result\n        const { header, results } = excel.read(data, 'array')\n        const tableTitle = header.map(item => { return { title: item, key: item } })\n        this.tableData = results\n        this.tableTitle = tableTitle\n        this.uploadLoading = false\n        this.tableLoading = false\n        this.showRemoveFile = true\n      }\n    }\n  },\n  created () {\n\n  },\n  mounted () {\n\n  }\n}\n</script>\n"]}]}